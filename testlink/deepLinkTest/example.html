<!doctype html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <script src="browser-deeplink.js" type="text/javascript"></script>
    
    <style>
    *, *:before, *:after {
        box-sizing: border-box;
    }
    a {
        font-family: monospace;
        display: block;
        width: 100%;
        margin: 10px 0;
        padding: 25px;
        background: #060;
        color:#fff;
        text-align: center;
        font-size: 20px;
    }
    </style>
</head>
<body>
    <h3>新連結測試</h3>
    <a id="test" href="#" data-uri="mymojiStage://open" onclick="clickHandler(this.dataset.uri)">mymojiStage://open</a>
    </br>
    <a href="#" data-uri="mymojiStage://open?action=page_sticker_store" onclick="clickHandler(this.dataset.uri)">new 貼圖商店</a>
    </br>
    <a href="#" data-uri="mymojiStage://open?action=delete_avatar" onclick="clickHandler(this.dataset.uri)">new 刪除模型</a>
    </br>
    <a href="#" data-uri="mymojiStage://open?action=appearance_setting&avatarId=123456" onclick="clickHandler(this.dataset.uri)">new 編輯外觀</a>
    </br>

    <h3>舊連結測試</h3>
    <a href="#" data-uri="https://mymojistage.page.link/store" onclick="clickHandler(this.dataset.uri)">old 貼圖商店</a>
    </br>
    <a href="#" data-uri="https://mymojistage.page.link/deleteAvatar" onclick="clickHandler(this.dataset.uri)">old 刪除模型</a>
    </br>
    <a href="#" data-uri="https://mymojistage.page.link/download" onclick="clickHandler(this.dataset.uri)">old download</a>
    </br>

    <h3>開發測試</h3>
    <a href="#" data-uri="mymojiStage" onclick="clickHandler(this.dataset.uri)">open mymojiStage: 無效//</a>
    </br>
    123
    </br>
    <button id="test_button" href="#">open mymojiStage://open</button>
    </br>
    <a href="#" data-uri="fb://profile" onclick="clickHandler(this.dataset.uri)">open fb://profile</a>
    </br>
</body>

    <script type="text/javascript">

    // deeplink.setup({
    //     iOS: {
    //         appId: "284882215",
    //         appName: "facebook",
    //     },
    //     android: {
    //         appId: "com.facebook.katana"
    //     }
    // });

    deeplink.setup({
        iOS: {
            appId: "1571072463",
            appName: "mymojiStage",
        },
        android: {
            appId: "com.taiwanmobile.myMojiStage"
        }
    });

    // deeplink.setup({
    //     iOS: {
    //         appId: "1558996892",
    //         appName: "mymoji",
    //     },
    //     android: {
    //         appId: "com.taiwanmobile.myMojiApp"
    //     }
    // });

    function clickHandler(uri) {
        deeplink.open(uri);
        return false;
    }

    let testa = document.getElementById("test");
    testa.click();

    // testa.addEventListener('load', window.location.assign("fb://profile"), false);
    // document.getElementById("test_button").addEventListener('load', testa.click(), false);

    // testa.addEventListener('click', () => {
    //     // window.location.assign("fb://profile"); // your deep link here
    //     // clickHandler("fb://profile");
    //     window.location.assign("intent://open?ln=/page_sticker_store#Intent;scheme=mymojiStage;package=com.taiwanmobile.myMojiStage;end");
    //     // window.location.href = "intent://open?ln=/page_sticker_store#Intent;scheme=mymojiStage;package=com.taiwanmobile.myMojiStage;end";
    // });

    // testa.click();

    // if (window.BOQ_loadedInitialJS) {clickHandler("mymojiStage://open");} else {testa.addEventListener('load', clickHandler("mymojiStage://open"), false);}

    // const appScheme = 'intent://open?ln=/page_sticker_store#Intent;scheme=mymojiStage;package=com.taiwanmobile.myMojiStage;end';
    // const appStoreURL = 'https://apps.apple.com/app/com.taiwanmobile.myMojiStage';
    // const playStoreURL = 'https://play.google.com/store/apps/details?id=com.taiwanmobile.myMojiStage';

    // const openApp = () => {
    //     // Attempt to open the app using window.location.href
    //     window.location.href = appScheme;

    //     // If not successful within 1.5 seconds, redirect to the store
    //     setTimeout(() => {
    //         window.location.href = storeURL;
    //     }, 1500);
    // };

    // // Optional: Attempt to open the app using window.open as a fallback
    // const openAppWithWindowOpen = () => {
    //     const newWindow = window.open(appScheme, '_self');
    //     if (newWindow) {
    //         newWindow.close();
    //     }

    //     setTimeout(() => {
    //         window.location.href = storeURL;
    //     }, 1500);
    // };

    // openApp();
    // // openAppWithWindowOpen();

    // // window.onload = openApp;

    </script>
    
</html>
